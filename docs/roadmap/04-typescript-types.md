# Auto-generated TypeScript Types

**Priority**: High  
**Effort**: Medium (leveraging existing tools)  
**Status**: üî¥ Not Started  
**Phase**: 1 (Essential Features)

## Description

Integrate Contentstack's existing CLI tsgen plugin into the Nuxt module workflow for automatic TypeScript type generation.

## Goal

Provide automatic TypeScript type generation from Contentstack Content Types using the official Contentstack CLI, integrated seamlessly into the Nuxt development workflow.

## Leveraging Contentstack CLI tsgen Plugin

Contentstack already provides a powerful CLI plugin `contentstack-cli-tsgen` that generates TypeScript typings from Content Types. Instead of building our own solution, we can integrate this existing tool into our Nuxt module workflow.

## Contentstack CLI tsgen Plugin Overview

```bash
# Install the plugin
$ csdx plugins:install contentstack-cli-tsgen

# Generate TypeScript types
$ csdx tsgen -a "delivery_token_alias" -o "types/contentstack.d.ts" -p "I" -d
```

## Plugin Options

- `-a, --token-alias`: (Required) Delivery token alias
- `-o, --output`: (Required) Full path to the output file
- `-p, --prefix`: Interface prefix (e.g., "I" for IPage, IArticle)
- `-d, --[no-]doc`: Include JSDoc documentation comments

## Implementation Strategy

Rather than creating our own type generator, we should:

1. **Integrate the existing CLI** - Wrap the Contentstack CLI tsgen command
2. **Automate the workflow** - Run type generation as part of dev/build process
3. **Configure seamlessly** - Use module config for CLI parameters
4. **Watch for changes** - Regenerate types when content models change

## Implementation Details

- Create wrapper script that calls `csdx tsgen` with module configuration
- Add npm scripts and Nuxt hooks to automate type generation
- Use module config (API key, delivery token) for CLI authentication
- Provide developer-friendly commands and watch mode
- Handle CLI installation and setup automatically

## Files to create

- `src/cli/tsgen-wrapper.ts` - Wrapper for Contentstack CLI tsgen
- `src/utils/cli-installer.ts` - Auto-install Contentstack CLI if needed
- `scripts/generate-types.js` - npm script for type generation
- `src/module.ts` - Add build hooks for automatic generation

## Module Configuration Integration

```typescript
// nuxt.config.ts
export default defineNuxtConfig({
  contentstack: {
    apiKey: "blt...",
    deliveryToken: "cs...",
    environment: "preview",

    // TypeScript generation config
    typeGeneration: {
      enabled: true,
      outputPath: "types/contentstack.d.ts",
      prefix: "", // Interface prefix (optional)
      includeDocs: true, // Include JSDoc comments
      watchMode: true, // Regenerate on content model changes
    },
  },
});
```

## Developer Commands

```bash
# Generate types manually
npx nuxi contentstack:generate-types

# Generate types with watch mode
npx nuxi contentstack:generate-types --watch

# Validate and test type generation
npx nuxi contentstack:validate-types
```

## Example Generated Types

By Contentstack CLI:

```typescript
// Generated by contentstack-cli-tsgen
export interface Page {
  title: string;
  description?: string;
  image?: Asset;
  blocks?: Array<HeroBlock | TextBlock | ImageBlock>;
  seo?: SEOMetadata;
  url: string;
  _metadata: Metadata;
}

export interface HeroBlock {
  title: string;
  subtitle?: string;
  cta_text: string;
  cta_link: Link;
}

export interface Asset {
  uid: string;
  url: string;
  title: string;
  filename: string;
  content_type: string;
  file_size: string;
}
```

## Advantages of Using Existing CLI

- ‚úÖ **Official tool** - Maintained by Contentstack team
- ‚úÖ **Battle-tested** - Used in production by many projects
- ‚úÖ **Feature complete** - Handles complex types, references, and nested structures
- ‚úÖ **Always up-to-date** - Automatically supports new Contentstack features
- ‚úÖ **No maintenance** - We don't need to maintain a custom type generator
- ‚úÖ **Documentation generation** - Includes JSDoc comments
- ‚úÖ **Professional output** - Clean, well-structured TypeScript interfaces

## Implementation Steps

1. **Create CLI wrapper** - Abstract the `csdx tsgen` command
2. **Add module integration** - Hook into Nuxt build process
3. **Configure automation** - Auto-generate on content model changes
4. **Add developer commands** - Provide easy-to-use CLI commands
5. **Handle installation** - Auto-install Contentstack CLI if needed
6. **Add validation** - Verify generated types are valid
7. **Test integration** - Ensure types work with composables

## Expected Outcome

After implementation, developers get:

- ‚úÖ **Automatic type generation** - Types created from Contentstack Content Types
- ‚úÖ **IDE support** - Full IntelliSense and type checking
- ‚úÖ **Type safety** - Catch errors at compile time
- ‚úÖ **Developer experience** - Easy-to-use commands and automation
- ‚úÖ **Watch mode** - Auto-regenerate when content models change
- ‚úÖ **Configuration-driven** - Uses existing module config for authentication

## Benefits

- üîß **Easy setup** - One command to generate all types
- üéØ **Accurate types** - Generated directly from content models
- ‚ö° **Fast development** - IntelliSense speeds up coding
- üõ°Ô∏è **Type safety** - Catch content structure errors early
- üîÑ **Always synced** - Types match current content models
- üìö **Self-documenting** - JSDoc comments explain field purposes
